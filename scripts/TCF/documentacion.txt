La cadena TCString de TCF IAB v2 se construye siguiendo el formato especificado por el IAB Tech Lab¬π. El formato consta de cuatro partes: el *core string, el **publisher restrictions segment, el **disclosed vendors segment* y el *allowed vendors segment*. Cada parte tiene una estructura binaria que codifica la informaci√≥n sobre el consentimiento del usuario, las restricciones del editor, los proveedores revelados y los proveedores permitidos. El orden en que se construye la cadena TCString es el siguiente:

- Primero, se genera el *core string*, que contiene la informaci√≥n b√°sica sobre el consentimiento del usuario, como la versi√≥n del TCF, el identificador del CMP, el prop√≥sito del consentimiento, etc.
- Segundo, se a√±ade el *publisher restrictions segment*, que contiene las restricciones que el editor impone a los proveedores para procesar los datos del usuario. Este segmento es opcional y solo se incluye si el editor tiene alguna restricci√≥n.
- Tercero, se a√±ade el *disclosed vendors segment*, que contiene la lista de los proveedores que el editor ha revelado al usuario. Este segmento es opcional y solo se incluye si el editor quiere informar al usuario de los proveedores que utiliza.
- Cuarto, se a√±ade el *allowed vendors segment*, que contiene la lista de los proveedores que el usuario ha permitido que procesen sus datos. Este segmento es opcional y solo se incluye si el usuario ha dado su consentimiento expl√≠cito a algunos proveedores.

La cadena TCString resultante se codifica en base64url y se separa por puntos entre cada segmento. Por ejemplo, una cadena TCString v√°lida podr√≠a ser:

`COwzjyOOwzjyOAGABCENAPCgAAAAAAAAAAiQAA.IFukWSQgAIQwgI0QEByFAAAAeIAACAAQAIAgEBCAagAQgBIA.QFukWSQgAIQwgI0QEByFAAAAeIAACAAQAIAgEBCAagAQgBIA.YFukWSQgAIQwgI0QEByFAAAAeIAACAAQAIAgEBCAagAQgBIA`

Para m√°s informaci√≥n sobre el formato y la estructura de la cadena TCString, puede consultar la documentaci√≥n del IAB Tech Lab¬π o el sitio web de IAB Europe¬≤. Tambi√©n puede encontrar recursos √∫tiles para los editores que quieran integrarse con la versi√≥n 2.0 del TCF de la IAB en los siguientes enlaces¬≥‚Å¥. Espero que esta respuesta le haya sido de ayuda. üòä

Origen: Conversaci√≥n con Bing, 22/9/2023
(1) TCString | @iabtcf/core - API Documentation. https://iabtcf.com/api/core/classes/tcstring.html.
(2) TCF v2.0 ‚Äì IAB Europe. https://iabeurope.eu/tcf-2-0/.
(3) Integraci√≥n de editores con la versi√≥n 2.0 del TCF de la IAB. https://support.google.com/admanager/answer/9805023?hl=es.
(4) Integraci√≥n de editores con la versi√≥n 2.0 del TCF de la IAB. https://support.google.com/admob/answer/9760862?hl=es.



__________________________

El orden de los par√°metros que se utilizan para construir la cadena TCString depende de la parte del formato que se est√© generando. Cada parte tiene una estructura binaria que codifica la informaci√≥n sobre el consentimiento del usuario, las restricciones del editor, los proveedores revelados y los proveedores permitidos. Los par√°metros que se usan para cada parte son los siguientes:

- Para el *core string*, los par√°metros son:
    - *Version*: el n√∫mero de versi√≥n del TCF que se est√° utilizando.
    - *Created*: la fecha y hora en que se cre√≥ la cadena TCString.
    - *LastUpdated*: la fecha y hora en que se actualiz√≥ la cadena TCString por √∫ltima vez.
    - *CmpId*: el identificador del CMP que ha obtenido el consentimiento del usuario.
    - *CmpVersion*: la versi√≥n del CMP que ha obtenido el consentimiento del usuario.
    - *ConsentScreen*: el n√∫mero de pantalla en el que el usuario ha dado su consentimiento.
    - *ConsentLanguage*: el c√≥digo de idioma en el que el usuario ha dado su consentimiento.
    - *VendorListVersion*: la versi√≥n de la lista de proveedores que se ha utilizado para obtener el consentimiento del usuario.
    - *TcfPolicyVersion*: la versi√≥n de la pol√≠tica del TCF que se ha aplicado para obtener el consentimiento del usuario.
    - *IsServiceSpecific*: un indicador de si la cadena TCString es espec√≠fica para un servicio o se puede compartir entre servicios.
    - *UseNonStandardStacks*: un indicador de si el editor ha utilizado pilas no est√°ndar para obtener el consentimiento del usuario.
    - *SpecialFeatureOptIns*: un vector de bits que indica si el usuario ha dado su consentimiento expl√≠cito a algunas caracter√≠sticas especiales, como el escaneo de contenido o el reconocimiento facial.
    - *PurposesConsent*: un vector de bits que indica si el usuario ha dado su consentimiento a los prop√≥sitos est√°ndar definidos por el IAB.
    - *PurposesLITransparency*: un vector de bits que indica si el usuario ha dado su transparencia al tratamiento leg√≠timo de sus datos por parte de los proveedores para los prop√≥sitos est√°ndar definidos por el IAB.
    - *PurposeOneTreatment*: un indicador de si el usuario est√° sujeto o no al tratamiento del prop√≥sito uno, que se refiere al almacenamiento y acceso a la informaci√≥n en el dispositivo del usuario.
    - *PublisherCC*: el c√≥digo de pa√≠s del editor, que se utiliza para determinar el tratamiento del prop√≥sito uno.
    - *VendorConsent*: un vector de bits que indica si el usuario ha dado su consentimiento a los proveedores que figuran en la lista de proveedores.
    - *VendorLITransparency*: un vector de bits que indica si el usuario ha dado su transparencia al tratamiento leg√≠timo de sus datos por parte de los proveedores que figuran en la lista de proveedores.
    - *PublisherRestrictions*: un vector de bits que indica si el editor ha impuesto alguna restricci√≥n a los proveedores para procesar los datos del usuario para algunos prop√≥sitos.

- Para el *publisher restrictions segment*, los par√°metros son:
    - *NumPubRestrictions*: el n√∫mero de restricciones que el editor ha impuesto a los proveedores.
    - *PurposeId*: el identificador del prop√≥sito para el que se aplica la restricci√≥n.
    - *RestrictionType*: el tipo de restricci√≥n que se aplica, que puede ser: no hay restricci√≥n, requiere consentimiento, requiere transparencia de tratamiento leg√≠timo o requiere consentimiento y transparencia de tratamiento leg√≠timo.
    - *NumEntries*: el n√∫mero de entradas que especifican los proveedores a los que se aplica la restricci√≥n.
    - *IsARange*: un indicador de si la entrada es un rango o una lista de proveedores individuales.
    - *StartOrOnlyVendorId*: el identificador del primer proveedor o del √∫nico proveedor al que se aplica la restricci√≥n.
    - *EndVendorId*: el identificador del √∫ltimo proveedor al que se aplica la restricci√≥n, si la entrada es un rango.

- Para el *disclosed vendors segment*, los par√°metros son:
    - *MaxVendorId*: el identificador m√°ximo de los proveedores que el editor ha revelado al usuario.
    - *IsARange*: un indicador de si el segmento es un rango o una lista de proveedores individuales.
    - *StartOrOnlyVendorId*: el identificador del primer proveedor o del √∫nico proveedor que el editor ha revelado al usuario.
    - *EndVendorId*: el identificador del √∫ltimo proveedor que el editor ha revelado al usuario, si el segmento es un rango.

- Para el *allowed vendors segment*, los par√°metros son:
    - *MaxVendorId*: el identificador m√°ximo de los proveedores que el usuario ha permitido que procesen sus datos.
    - *IsARange*: un indicador de si el segmento es un rango o una lista de proveedores individuales.
    - *StartOrOnlyVendorId*: el identificador del primer proveedor o del √∫nico proveedor que el usuario ha permitido que procesen sus datos.
    - *EndVendorId*: el identificador del √∫ltimo proveedor que el usuario ha permitido que procesen sus datos, si el segmento es un rango.

Espero que esta respuesta le haya aclarado el orden de los par√°metros que se utilizan para construir la cadena TCString. Si tiene alguna otra pregunta, no dude en preguntarme. üòä

: [TCF v2.0 - Transparency & Consent String with Global Vendor List Format](https://github.com/InteractiveAdvertisingBureau/GDPR-Transparency-and-Consent-Framework/blob/master/TCFv2/IAB%20Tech%20Lab%20-%20Consent%20string%20and%20vendor%20list%20formats%20v2.md)
: [IAB Europe Transparency & Consent Framework](https://iabeurope.eu/tcf-2-0/)
: [TCF v2.0 - Publisher Implementation Guide](https://iabeurope.eu/wp-content/uploads/2020/05/TCF-v2.0-Publisher-Implementation-Guide-v1.0.pdf)
: [TCF v2.0 - CMP API v2](https://github.com/InteractiveAdvertisingBureau/GDPR-Transparency-and-Consent-Framework/blob/master/TCFv2/IAB%20Tech%20Lab%20-%20CMP%20API%20v2.md)